# This uses newer and faster docker based build system
sudo: false

language: php

services: mysql

notifications:
  on_success: never
  on_failure: change

php:
  - nightly
  - 7.3

matrix:
  allow_failures:
    - php: nightly

env:
  global:
    # This variable will be used as the name and hostname of the container.
    - DOCKER_CONTAINER=wordpress

script:
  # Run CI tests defined in the .seravo-ci script in the root of this project.
  # The tests are run inside a seravo/wordpress:ci image that starts a WordPress
  # installation out-of-the-box. Being based on our local development environment,
  # the tests run in an environment that resembles production as closely as possible.
  - >
    docker run --name ${DOCKER_CONTAINER}
    --hostname ${DOCKER_CONTAINER}
    --volume /tmp/data/:/data
    --volume ${PWD}:/data/wordpress
    --entrypoint /sbin/swd_init
    -it seravo/wordpress:ci
